# í”„ë¡ì‹œ

> ì—”í‹°í‹°ì™€ ë™ì¼í•œ í•„ë“œë¥¼ ê°€ì§„ ê»ë°ê¸° ì—”í‹°í‹°ë¥¼ í”„ë¡ì‹œë¼ê³ í•œë‹¤.(ê·¸ëƒ¥ ë¹ˆ ê»ë°ê¸°)
> 

<aside>
ğŸ’¡ í”„ë¡ì‹œ == ì§€ì—°ë¡œë”©

</aside>

### ì™œ í”„ë¡ì‹œê°€ í•„ìš”í•´?

- ì—”í‹°í‹°ì˜ ì—°ê´€ëœ ë‹¤ë¥¸ ì—”í‹°í‹°ë¥¼ í•„ìš”í•  ë•Œê¹Œì§€ ë¡œë“œí•˜ì§€ ì•Šë„ë¡ í•´ì¤€ë‹¤. â€”> ì§€ì—° ë¡œë”© â†’ ì„±ëŠ¥ ìµœì í™”
    - member.getName()ì„ í–ˆì„ë•Œ member ê³ ìœ ì˜ ëª¨ë“  ì†ì„±ì— ëŒ€í•œ ë°ì´í„°ëŠ” ì¡°íšŒë˜ì–´ ë„˜ì–´ì˜¤ì§€ë§Œ ì—°ê´€ê´€ê³„ì— ìˆëŠ” Teamì— ëŒ€í•œ ë°ì´í„°ëŠ” ê°€ì ¸ì˜¤ì§€ ì•ŠëŠ”ë‹¤.
    - íŠ¹ì • í•„ë“œë§Œ ê°€ì ¸ì˜¤ëŠ”ê±´ ì•„ë‹ˆë‹¤.

### ì‚¬ìš©ë²• â‡’ ê·¸ëƒ¥ ì—”í‹°í‹° ì‚¬ìš©í•˜ëŠ”ê±°ë‘ ë˜‘ê°™ì´ ì‚¬ìš©

```java
// member ì—”í‹°í‹°ê°€ ì•„ë‹Œ í”„ë¡ì‹œ memberë¥¼ ë°˜í™˜
Member member = em.getReference(Member.class, "id1");
// í”„ë¡ì‹œëŠ” ì§„ì§œ member ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì— ë©”ì†Œë“œ í˜¸ì¶œì‹œ ì§„ì§œ member ì—”í‹°í‹°ì˜ ë©”ì„œë“œ í˜¸ì¶œ
member.getName();
```

- `em.getReferece()`ë¥¼ í†µí•´ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜ ë°›ëŠ”ë‹¤.
    - ë§Œì•½ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ë¯¸ í•´ë‹¹ ì—”í‹°í‹°ê°€ ì¡´ì¬í•œë‹¤ë©´ ì§„ì§œ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.

### ì£¼ì˜ì‚¬í•­

- ì—”í‹°í‹°ê°€ ì¤€ ì˜ì† ìƒíƒœì¼ë•Œ í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ë©´ `LazyInitializationException` ì˜ˆì™¸ í„°ì§
- í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ê°€ ì§€ì—°ë¡œë”©ì˜ ì´ì ì„ ëˆ„ë¦¬ê¸° ìœ„í•¨ì¸ë° ì§€ì—° ë¡œë”©ì´ ê°€ëŠ¥í•˜ë ¤ë©´ í•´ë‹¹ ì—”í‹°í‹°ë¥¼ í†µí•´ ì–¸ì œë“ ì§€ DBì—ì„œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´ì•¼í•¨(ì˜ì† ìƒíƒœ). ê·¼ë° ì¤€ ì˜ì† ìƒíƒœë¡œ ê°€ë²„ë¦¬ë©´ í•´ë‹¹ ì—”í‹°í‹°ë¡œ DBì— ì ‘ê·¼ í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ì§€ì—° ë¡œë”© ë˜í•œ í•˜ì§€ ëª»í•¨. ê·¸ë˜ì„œ í”„ë¡ì‹œë„ ì´ˆê¸°í™” í•˜ì§€ ëª»í•˜ëŠ”ê²ƒ.
- ì˜ì† ìƒíƒœ
    - ì—”í‹°í‹°ê°€ 'ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸'ì™€ ì—°ê²°ë˜ì–´ ìˆì–´, ì–¸ì œë“ ì§€ í•„ìš”í•  ë•Œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ì‘ìš©(ë°ì´í„° ë¡œë“œ ë° ì €ì¥ ë“±)ì´ ê°€ëŠ¥í•œ ìƒíƒœ â€”> ì§€ì—° ë¡œë”© ê°€ëŠ¥ â€”> í”„ë¡ì‹œ ì´ˆê¸°í™” ê°€ëŠ¥
- ì¤€ ì˜ì† ìƒíƒœ
    - ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬ë˜ì–´, ë” ì´ìƒ ë°ì´í„°ë² ì´ìŠ¤ì™€ ìë™ìœ¼ë¡œ ìƒí˜¸ì‘ìš©í•˜ì§€ ì•ŠëŠ” ìƒíƒœì…ë‹ˆë‹¤. ì¦‰, ì´ ìƒíƒœì—ì„œëŠ” ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. â€”> ì§€ì—° ë¡œë”© ë¶ˆê°€ëŠ¥â€”> í”„ë¡ì‹œ ì´ˆê¸°í™” ë¶ˆê°€ëŠ¥

### ì–´ë–»ê²Œ ì´ê²Œ ê°€ëŠ¥í•œê°€?

- í”„ë¡ì‹œëŠ” ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì°¸ì¡°ê°’ì„ ê°€ì§€ê³ ìˆìŒ
- ì°¸ì¡°ê°’ì„ ê°€ì§€ê³ ìˆë‹¤ê°€ ì‹¤ì œë¡œ ë©”ì„œë“œ í˜¸ì¶œì´ ì¼ì–´ë‚¬ì„ ë•Œ ì§„ì§œ ì—”í‹°í‹°ë¡œ ì—°ê²°í•´ì„œ ë©”ì„œë“œë¥¼ ë™ì‘ì‹œí‚´

### í”„ë¡ì‹œë¥¼ ì´ìš©í•´ member.GetName(); í–ˆì„ ë•Œ ë‚´ë¶€ì—ì„œ ì¼ì–´ë‚˜ëŠ” ë¡œì§

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e8dc9b1a-ebd7-4746-8b87-278cc7cc5d56/d778d681-81c4-4a4b-b992-bbf500098a98/Untitled.png)

1. í”„ë¡ì‹œ ì´ˆê¸°í™” : í”„ë¡ì‹œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì‹¤ì œ ì—”í‹°í‹° ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ìš”ì²­í•˜ê³  í•´ë‹¹ ì—”í‹°í‹°ì˜ ì°¸ì¡° ê°’ìœ¼ë¡œ ê°±ì‹ ë¨.
2. ì‹¤ì œ ì—”í‹°í‹° ë¡œë“œ : DB ì¡°íšŒë¥¼ í†µí•´ ì§„ì§œ ì—”í‹°í‹°ë¥¼ ìƒì„±
3. ì´ˆê¸°í™” ëœ í”„ë¡ì‹œë¥¼ í†µí•´ ì‹¤ì œ ì—”í‹°í‹°ì˜ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ë©° ìš”êµ¬í•œ ê°’ì´ ë°˜í™˜ë¨

### í”„ë¡ì‹œì˜ ë‹¨ì  : ì§€ì—° ë¡œë”© vs ì¦‰ì‹œ ë¡œë”©

```java
String name = member.GetName();
Tema team = member.GetTeam();
```

- í”„ë¡ì‹œë¥¼ í†µí•œ ì§€ì—° ë¡œë”©ì˜ ê²½ìš° ì¿¼ë¦¬ê°€ 2 ë²ˆ ë‚˜ê°€ê³  DB ì¡°íšŒê°€ 2ë²ˆ ì¼ì–´ë‚¨
    - member.GetName() : Memberì™€ ì—°ê´€ê´€ê³„ì— ìˆëŠ” Teamì—”í‹°í‹°ëŠ” ë¹¼ê³  ëª¨ë“  ì†ì„± ë°ì´í„°ë¥¼ ëŒê³ ì™€ì„œ member ì—”í‹°í‹°ë¥¼ ìƒì„±í•˜ê³  .GetName() ë©”ì„œë“œ ë™ì‘
    - member.GetTeam(); : ê¸°ì¡´ì˜ member ì—”í‹°í‹°ì˜ ì†ì„± ì •ë³´ì— teamì´ ì—†ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ í•œë²ˆ ì¿¼ë¦¬ ì³ì„œ memberì— team ì •ë³´ë¥¼ ì±„ì›Œì£¼ê³  GetTeam() ë©”ì„œë“œ ì‹¤í–‰í•´ì„œ íŒ€ì •ë³´ë¥¼ ë°˜í™˜
- í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì¦‰ì‹œ ë¡œë”©ì˜ ê²½ìš° ì¿¼ë¦¬ê°€ 1ë²ˆ ë‚˜ê°€ê³  DB ì¡°íšŒ ë˜í•œ 1ë²ˆ ì¼ì–´ë‚¨
    - member.GetName() : Memberì˜ ê³ ìœ  ì†ì„±ì •ë³´ì™€ ì—°ê´€ê´€ê³„ì— ìˆëŠ” ëª¨ë“  ì—”í‹°í‹°ì— ëŒ€í•œ ì •ë³´ë¥¼ í•œë²ˆì— ë‹¤ ëŒì–´ì˜´
    - member.GetTeam() : ì´ë¯¸ ì•ì˜ ìš”ì²­ìœ¼ë¡œ memberì— ëŒ€í•œ ëª¨ë“  ì†ì„± ì •ë³´ê°€ ìˆê¸° ë•Œë¬¸ì— DBì— ì¡°íšŒí•  í•„ìš” ì—†ì´ teamì„ ë°˜í™˜ í•¨.
- ë§Œì•½ì— member.GetTeam()ì„ í•˜ê³  member.GetName()ì„ í•˜ë©´ ì§€ì—°ë¡œë”©ì´ë¼ë„ DBì— 1ë²ˆë§Œ ì¡°íšŒí•˜ì§€ ì•Šì„ê¹Œ?
    - ì•„ë‹˜. ê·¸ëƒ¥ ì§€ì—°ë¡œë”© ì„¤ì • ìì²´ê°€ ì—°ê´€ê´€ê³„ì— ìˆëŠ” ì—”í‹°í‹°ë¥¼ ì¡°íšŒí• ë•Œ ë”± ê·¸ ì •ë³´ë§Œ ì°¾ì•„ì˜¤ê¸° ë•Œë¬¸ì— member.GetName() í•  ë•Œ ë‹¤ì‹œ DB ì¡°íšŒê°€ í•„ìš”í•¨.

# ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—° ë¡œë”©

> ì—°ê´€ê´€ê³„ ì„¤ì •ì´ ë˜ì–´ìˆëŠ” ì—”í‹°í‹°ì˜ ë¡œë”© ì‹œì ì„ ì„¤ì • í•  ìˆ˜ ìˆë‹¤.
> 

### ì¦‰ì‹œ ë¡œë”©

- `fetch = FetchType.EAGER`
- ì¦‰ì‹œ ë¡œë”©ìœ¼ë¡œ ì„¤ì •ëœ í•„ë“œëŠ” í•­ìƒ í•´ë‹¹ ì—”í‹°í‹°ê°€ ì¡°íšŒë  ë•Œ â€œê°™ì´â€ DBì—ì„œ ì¡°íšŒë˜ì–´ ì •ë³´ê°€ ë°˜í™˜ ë¨.
- ìµœì í™”ë¥¼ í•œë‹¤ë©´ DB ì ‘ê·¼ì„ ìµœì í™” í•˜ë©´ì„œ ì„±ëŠ¥ì„ ì´ëŒì–´ ë‚¼ ìˆ˜ ìˆì§€ë§Œ ì¿¼ë¦¬ê°€ ì´ìƒí•˜ê²Œ ë‚˜ê°€ ì‹ ë¢°ì„±ì˜ ë¬¸ì œê°€ ìˆì–´ ì‹¤ë¬´ì—ì„  ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•¨.
- OneToOne, ManyToOneê³¼ ê°™ì´ Oneìœ¼ë¡œ ëë‚˜ëŠ” ì• ë“¤ì€ ë¡œë”© ë””í´íŠ¸ ê°’ì´ ì¦‰ì‹œ ë¡œë”©ìœ¼ë¡œ ì„¤ì • ë˜ì–´ìˆìŒ =â‡’ ê·¸ë˜ì„œ ì§€ì—°ë¡œë”©ìœ¼ë¡œ ë¡œë”© ì„¤ì • ë°”ê¿”ì¤˜ì•¼í•¨

### ì§€ì—° ë¡œë”©

- `fetch = FetchType.LAZY`
- ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì„¤ì •ëœ í•„ë“œëŠ” í•´ë‹¹ í•„ë“œë¥¼ ê¼­ ì§‘ì–´ ì¡°íšŒí•˜ì§€ ì•Šìœ¼ë©´ DBì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ì•ŠìŒ
- ì‹¬ì§€ì–´ ê¼­ ì§‘ì´ ì¡°íšŒí•´ë„ ë”± í•´ë‹¹ í•„ë“œì˜ ì •ë³´ë§Œ ë°˜í™˜í•˜ëŠ” ì‹¸ê°€ì§€ ì—†ëŠ” ë¡œë”© ì„¤ì • í•˜ì§€ë§Œ ì¿¼ë¦¬ì˜ ì‹ ë¢°ì„±ì´ ë†’ì•„ì„œ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©.
- OneToMany, ManyToManyëŠ” ê¸°ë³¸ì´ ì§€ì—°ë¡œë”©

### N + 1 ë¬¸ì œ

- ì¦‰ì‹œ ë¡œë”©ì‹œ ë°œìƒí•˜ëŠ” N + 1
    - ê¸°ë³¸ì ìœ¼ë¡œ JPQL ì‚¬ìš©ì‹œ ë°œìƒí•¨
    - Member, Teamì´ ì¦‰ì‹œ ë¡œë”© ê´€ê³„ì¼ë•Œ
    - ë§Œì•½ ëª¨ë“  ìœ ì €ì˜ ì´ë¦„ì„ ì¡°íšŒí•˜ëŠ” JPQLì„ ì‘ì„±í–ˆë‹¤ê³  ê°€ì •
    - ê·¸ëƒ¥ ìœ ì €ì •ë³´ë§Œ ì¡°íšŒí•˜ë©´ ëë‚˜ëŠ”ë° ì¦‰ì‹œ ë¡œë”©ì´ ë˜ì—ˆìˆê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ê° ìœ ì €ë³„ë¡œ íŒ€ì„ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ê¹Œì§€ ë‚˜ê°€ê²Œ ë˜ì–´ ë¹„íš¨ìœ¨ì ì„
- ì§€ì—° ë¡œë”©ì‹œ ë°œìƒí•˜ëŠ” N + 1
    - í•œë°©ì— ê°€ì ¸ì˜¤ë©´ DB 1íšŒ ì¡°íšŒë¥¼ í•œ ê²°ê³¼ë¡œ ì´í›„ì— í•„ìš”í•œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ëŠ”ë°
    - ê·¸ê²Œ ì•ˆë¨ ë¬´ì¡°ê±´ ì—°ê´€ê´€ê³„ì— ìˆëŠ” ì—”í‹°í‹° ì¡°íšŒ ë‹¹ 1íšŒì˜ ì¿¼ë¦¬ì™€ DB ì¡°íšŒê°€ ë°œìƒí•¨.
- í•´ê²°ì±…
    - JPQL í˜ì¹˜ ì¡°ì¸(Fetch Join)
    - @EntityGraph
    - ë¡œë”© ì „ëµ ë³€ê²½

# ì˜ì†ì„± ì „ì´

> ì—°ê´€ ê´€ê³„ë¡œ ì„¤ì •ëœ ì—”í‹°í‹°ê°€ ì˜ì†ì„± ìƒíƒœë¡œ ë“¤ì–´ê°ˆ ë•Œ ì—°ê´€ ê´€ê³„ì— ìˆëŠ” ì—”í‹°í‹° ë˜í•œ ì˜ì†ì„± ìƒíƒœë¡œ ë“¤ì–´ê°€ë„ë¡ ì„¤ì •í•˜ëŠ” ê²ƒ. ë§ ê·¸ëŒ€ë¡œ ì˜ì†ì„±ì´ ì „ì´ë˜ëŠ” ê²ƒ.
> 

<aside>
ğŸ’¡ ì—°ê´€ê´€ê³„ ì„¤ì •í•˜ëŠ”ê±´ ê·¸ëƒ¥ ìë°” ê°ì²´ë¡œ í…Œì´ë¸” ë§Œë“œëŠ” ê²ƒì—ì„œ ëì´ë‹¤. í…Œì´ë¸” ë°ì´í„°ë¥¼ ë³€ê²½í•˜ëŠ”ê±´ ê´€ë ¨ëœ ì—”í‹°í‹°ê°€ ì˜ì†ì„± ìƒíƒœì— ë“¤ì–´ ìˆì–´ì•¼ DBì— ë°˜ì˜ì´ë¨.

</aside>

### ì™œ ì‚¬ìš©í•˜ëŠ”ë°?

- ê·¼ë³¸ì ìœ¼ë¡œ ê°œë°œìì˜ ì‹¤ìˆ˜ì—(ì˜ì†ì„± ìƒíƒœ ê´€ë¦¬ ë¶€ì‹¤)ì˜í•´ ë°ì´í„° ë¬´ê²°ì„±ì´ ê¹¨ì§€ëŠ” ê²ƒì„ ë§‰ì•„ì¤€ë‹¤.
    - ì—°ê´€ê´€ê³„ì— ìˆëŠ” ì• ë“¤ ì˜ ê´€ë¦¬ í•´ì¤„ ìì‹  ìˆìœ¼ë©´ ì˜ì†ì„± ì „ì´ ì‚¬ìš©ì•ˆí•´ë„ ë¨
- ë°˜ë³µ ì‘ì—…ì„ ì¤„ì—¬ ì½”ë“œê°€ ê°„ê²°í•´ì§„ë‹¤.

### ì˜ì†ì„± ì „ì´ ë¹„ì‚¬ìš© vs ì˜ì†ì„± ì „ì´ ì‚¬ìš©

```java
@Entity
public class Parent {
    @Id
    @GeneratedValue
    private Long id;

    // ì˜ì†ì„± ì „ì´ ì„¤ì • ì—†ìŒ
    @OneToMany(mappedBy = "parent")
    private List<Child> children = new ArrayList<>();
}

@Entity
public class Child {
    @Id
    @GeneratedValue
    private Long id;

    @ManyToOne
    @JoinColumn(name = "parent_id")
    private Parent parent;
}

// ì—”í‹°í‹° ì €ì¥ ì½”ë“œ
Parent parent = new Parent();
Child child1 = new Child();
Child child2 = new Child();

child1.setParent(parent);
child2.setParent(parent);
parent.getChildren().add(child1);
parent.getChildren().add(child2);

// ë³€ê²½ ì‚¬í•­ì´ ìˆëŠ” ëª¨ë“  ì—°ê´€ê´€ê³„ì˜ ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ìƒíƒœë¡œ ë³€ê²½í•´ì•¼ ë³€ê²½ì‚¬í•­ì´ DBì— ë°˜ì˜ë¨
em.persist(parent);
em.persist(child1);
em.persist(child2);
```

- ë¬¸ì œì  : ë§Œì•½ em.persist(child2); ì´ê±° ë¹ ëœ¨ë¦¬ë©´ Childe í…Œì´ë¸”ì— child2 ìì²´ê°€ ì¶”ê°€ê°€ ì•ˆë¨. ê·¸ëŸ¬ë©´ ì´í›„ì— DBì—ì„œ parentë¥¼ ì°¾ì•„ì„œ ëª¨ë“  childë¥¼ ì¡°íšŒí•´ë„ child1ë§Œ ë‚˜ì˜¤ê³  child2ëŠ” ë‚˜ì˜¤ì§€ ì•ŠëŠ” ê°œ ã…ˆëœ ìƒí™©ì´ ë°œìƒí•˜ê²Œë¨.

```java
@Entity
public class Parent {
    @Id
    @GeneratedValue
    private Long id;

    // ì˜ì†ì„± ì „ì´ ì„¤ì •
    @OneToMany(mappedBy = "parent", cascade = CascadeType.PERSIST)
    private List<Child> children = new ArrayList<>();
}

@Entity
public class Child {
    @Id
    @GeneratedValue
    private Long id;

    @ManyToOne
    @JoinColumn(name = "parent_id")
    private Parent parent;
}

// ì—”í‹°í‹° ì €ì¥ ì½”ë“œ
Parent parent = new Parent();
Child child1 = new Child();
Child child2 = new Child();

child1.setParent(parent);
child2.setParent(parent);
parent.getChildren().add(child1);
parent.getChildren().add(child2);

em.persist(parent); // ì—¬ê¸°ì„œ parentì™€ ì—°ê´€ëœ child1, child2ë„ í•¨ê»˜ ì €ì¥ë¨
```

- ì¥ì 
    - ê·¸ëƒ¥ ì—°ê´€ê´€ê³„ì—ì„œ 1ì¸ ì—”í‹°í‹°ë¥¼ ì˜ì†ìƒíƒœë¡œ ë³€ê²½í•´ì£¼ê¸°ë§Œ í•˜ë©´ ì—°ê´€ê´€ê³„ì— ìˆëŠ” ì—”í‹°í‹°ê°€ ì•Œì•„ì„œ ì˜ì† ìƒíƒœì— ë“¤ì–´ê°€ë©´ì„œ ë³€ê²½ ì •ë³´ê°€ ë°˜ì˜ë¨.

### ì „ëµ

> ì£¼ë¡œ 1 : N ê´€ê³„ì—ì„œ 1ì˜ ì—”í‹°í‹°ì— ì—°ê´€ê´€ê³„ê°€ ì„¤ì •ëœ ì—”í‹°í‹°ì— ê±¸ì–´ì¤€ë‹¤.(@OneToMany() ì˜ cascadeì†ì„±ìœ¼ë¡œ ê±¸ì–´ì£¼ë©´ ë¨)
> 
- `cascade = CascadeType.PERSIST`
    - íŒ€ì´ ì‚¬ë¼ì§„ë‹¤ê³  í•´ì„œ ê·¸ íŒ€ì— ìˆëŠ” ë©¤ë²„ê°€ ë©¤ë²„ í…Œì´ë¸”ì—ì„œ ì—†ì–´ì§€ì§€ ì•ŠìŒ ê·¸ëƒ¥ ë©¤ë²„ì˜ íŒ€ í•„ë“œì˜ ê°’ì— ìˆ˜ì •ì´ ìˆì„ ë¿ì¸ ê´€ê³„

```java
@Entity
public class Parent {
    @Id
    @GeneratedValue
    private Long id;

    // ì˜ì†ì„± ì „ì´ ì„¤ì •
    @OneToMany(mappedBy = "parent", cascade = CascadeType.PERSIST)
    private List<Child> children = new ArrayList<>();
}

@Entity
public class Child {
    @Id
    @GeneratedValue
    private Long id;

    @ManyToOne
    @JoinColumn(name = "parent_id")
    private Parent parent;
}

// ì—”í‹°í‹° ì €ì¥ ì½”ë“œ
Parent parent = new Parent();
Child child1 = new Child();
Child child2 = new Child();

child1.setParent(parent);
child2.setParent(parent);
parent.getChildren().add(child1);
parent.getChildren().add(child2);

em.persist(parent); // ì—¬ê¸°ì„œ parentì™€ ì—°ê´€ëœ child1, child2ë„ í•¨ê»˜ ì €ì¥ë¨

```

- `cascade = CascadeType.REMOVE`
    - íŒ€ì´ ì‚¬ë¼ì§€ë©´ ê·¸ íŒ€ì— ìˆëŠ” ë©¤ë²„ë„ ë©¤ë²„ í…Œì´ë¸”ì—ì„œ ì‚­ì œë˜ëŠ” ê´€ê³„

```java
@Entity
public class Parent {
    @Id
    @GeneratedValue
    private Long id;

    // ì˜ì†ì„± ì „ì´ ì„¤ì •
    @OneToMany(mappedBy = "parent", cascade = CascadeType.REMOVE)
    private List<Child> children = new ArrayList<>();
}

@Entity
public class Child {
    @Id
    @GeneratedValue
    private Long id;

    @ManyToOne
    @JoinColumn(name = "parent_id")
    private Parent parent;
}

// ì—”í‹°í‹° ì‚­ì œ ì½”ë“œ
Parent parent = em.find(Parent.class, parentId);

// cascade = CascadeType.REMOVE ì•ˆë˜ì–´ ìˆëŠ” ê²½ìš°
// for (Child child : parent.getChildren()) {
//     em.remove(child); // ê° Child ì—”í‹°í‹°ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‚­ì œ
// }
//

em.remove(parent); // Parent ì—”í‹°í‹°ë¥¼ ì‚­ì œí•  ë•Œ ì—°ê´€ëœ Child ì—”í‹°í‹°ë“¤ë„ í•¨ê»˜ ì‚­ì œë¨

```

- `cascade = CascadeType.PERSIST`+ `orphanRemoval = true`
    - íŒ€ì´ ì‚¬ë¼ì§„ê²½ìš° í•´ë‹¹ ë©¤ë²„ì˜ íŒ€ì´ ì‚¬ë¼ì§„ íŒ€ ë°–ì— ì—†ì—ˆë˜ê²½ìš° í•´ë‹¹ ë©¤ë²„ë„ ë©¤ë²„ í…Œì´ë¸”ì—ì„œ ì‚¬ë¼ì§€ëŠ” ê´€ê³„ ê³ ì•„ ê°ì²´ê°€ ë˜ì–´ë„ í•´ë‹¹ í…Œì´ë¸”ì—ì„œ ì‚¬ë¼ì§€ê²Œ í•˜ì§€ ì•Šìœ¼ë ¤ë©´  `orphanRemoval = true` ì´ê±° ì„¤ì • í•˜ë©´ ì•ˆë¨

```java
 @Entity
public class Parent {
    @Id
    @GeneratedValue
    private Long id;

    @OneToMany(mappedBy = "parent", cascade = CascadeType.PERSIST, orphanRemoval = true)
    private List<Child> children = new ArrayList<>();

    // Helper method to manage bi-directional relationship
    public void addChild(Child child) {
        children.add(child);
        child.setParent(this);
    }

    public void removeChild(Child child) {
        children.remove(child);
        child.setParent(null);
    }
}

@Entity
public class Child {
    @Id
    @GeneratedValue
    private Long id;

    @ManyToOne
    @JoinColumn(name = "parent_id")
    private Parent parent;
}

// ì—”í‹°í‹° ì €ì¥ ì½”ë“œ
Parent parent = new Parent();
Child child1 = new Child();
Child child2 = new Child();

parent.addChild(child1);
parent.addChild(child2);

em.persist(parent);

// ì—”í‹°í‹° ì‚­ì œ ì½”ë“œ
// ê³ ì•„ ê°ì²´ ì œê±°ë¥¼ í™œìš©í•˜ì—¬ Child ì—”í‹°í‹° ì‚­ì œ
parent.removeChild(child1); // ì´ Child ì¸ìŠ¤í„´ìŠ¤ëŠ” ê³ ì•„ ê°ì²´ê°€ ë˜ë©°, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìë™ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.

```

# ì‹¤ì „ ì˜ˆì œ